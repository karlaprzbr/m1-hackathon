!function(e){"use strict";e(document).ready((function(){let t,n=window.vmwpmdpContacter;if(e(".mdc-list .mdc-list-item.vmwpmdp-plugin-title").on("click",(function(){let t=e(this).data("count");void 0===t&&(t=0,setTimeout((function(){e(".mdc-list .mdc-list-item.vmwpmdp-plugin-title").removeData("count")}),2e3)),t++,e(this).data("count",t),t>3&&(e(".mdc-list > .mdc-list-item.vmwpmdp-developer").removeClass("mdc-hidden").addClass("mdc-list-item--activated"),e(".mdc-list .mdc-list-item.vmwpmdp-plugin-title").removeData("count"))})),e("#vmwpmdp-dev-reset-settings-btn").on("click",(function(t){t.preventDefault(),e(this).attr("disabled",!0).addClass("vmwpmdp-spin").find(".material-icons").text("refresh");let o={action:"reset_settings",nonce:n.nonce,doReset:!0};e.post(n.ajaxURL,o,(function(e){console.log("Settings Successfully Cleared.")}),"json").fail((function(e){console.log(e),alert("Looks like an Error has occurred. Please try again later.")})).always((function(){e("#vmwpmdp-dev-reset-settings-btn").attr("disabled",!1).removeClass("vmwpmdp-spin").find(".material-icons").text("clear_all")}))})),e("#vmwpmdp_custom_css_fld").length){let n=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};n.codemirror=_.extend({},n.codemirror,{indentUnit:2,tabSize:2,mode:"css"}),t=wp.codeEditor.initialize("vmwpmdp_custom_css_fld",n),t.codemirror.on("change",(function(n){t.codemirror.save(),e("#vmwpmdp_custom_css_fld").change()}))}e(".vmwpmdp-select-key-file-btn").on("click",(function(t){t.preventDefault();let n=e(this),o=wp.media({title:"Select or Upload API Key File",button:{text:"Use this API Key"},library:{type:["application/json","text/plain","json","text"]},multiple:!1}).on("select",(function(){let t=o.state().get("selection").first().toJSON();e(n).prev().val(t.id),e(n).next().text(t.filename),e("#submit").trigger("click")})).open()}));let o=e("#vmwpmdp-wpvoicemessage-settings-show-download-link");function i(){!0===o.prop("checked")?o.closest("tr").next().show(300):o.closest("tr").next().hide(300);let t=e("#vmwpmdp-wpvoicemessage-settings-download-link-text").parent().data("mdc-index");window.MerkulovMaterial[t].value=window.MerkulovMaterial[t].value}o.length&&(o.on("click",i),i());let s=e("#qcld_wpvm_vmwpmdp_voicemssg_settings_speech_recognition");function l(){!0===s.prop("checked")?(s.closest("tr").next().show(300).next().show(300).next().show(300),e("#vmwpmdp-wpvoicemessage-settings-dnd-api-key").val()||s.closest("tr").next().show().next().hide().next().hide()):s.closest("tr").next().hide(300).next().hide(300).next().hide(300)}s.length&&(s.on("click",l),l());let d=e("#qcld_wpvm_vmwpmdp_voicemssg_floatbutton_settings_show_fbutton");function r(){!0===d.prop("checked")?d.closest("tr").next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300).next().show(300):d.closest("tr").next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300).next().hide(300)}d.length&&(d.on("click",r),r());const a="#qcld_wpvm_vmwpmdp_voicemssg_floatbutton_settings_fbutton_icon";"none"===e(a+"_position").val()&&e(a).closest("tr").hide(),e(a+"_position").change((function(){"none"===this.value?e(a).closest("tr").hide(300):e(a).closest("tr").show(300)}));let c=e("#vmwpmdp-api-key-drop-zone");c.on("dragenter",(function(){f(),e(this).addClass("vmwpmdp-hover")})),c.on("dragleave",(function(){e(this).removeClass("vmwpmdp-hover")})),c.on("dragover",(function(e){e.stopPropagation(),e.preventDefault()}));let m=e("#vmwpmdp-wpvoicemessage-settings-dnd-api-key");function p(t){let n=new FileReader;n.onload=function(t){let n=t.target.result;return function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(n)?void 0===JSON.parse(n).private_key?(h("<b>Error</b>: Your API key file looks like not valid. Please make sure you use the correct key."),c.removeClass("vmwpmdp-busy"),void e(this).addClass("vmwpmdp-error")):(m.val(btoa(n)),f(),void(m.val().length>1e3?e("#submit").click():(h("<b>Error</b>: Your API key file looks like not valid. Please make sure you use the correct key."),c.removeClass("vmwpmdp-busy"),e(this).addClass("vmwpmdp-error")))):(h("<b>Error</b>: Uploaded file is empty or not a valid JSON file."),c.removeClass("vmwpmdp-busy"),void e(this).addClass("vmwpmdp-error"))},n.readAsText(t)}c.on("drop",(function(t){t.stopPropagation(),t.preventDefault(),e(this).removeClass("vmwpmdp-hover"),c.addClass("vmwpmdp-busy");let n=t.originalEvent.dataTransfer.files[0];x(n)?p(n):c.removeClass("vmwpmdp-busy")}));let u=e("#vmwpmdp-dnd-file-input");function h(e){c.next().addClass("vmwpmdp-error").html(e)}function f(){c.next().removeClass("vmwpmdp-error").html("")}function x(e){return null==e?(h("<b>Error</b>: Failed to read file. Please try again."),!1):!!e.type.match("application/json")||(h("<b>Error</b>: API Key must be a valid JSON file."),!1)}c.on("click",(function(){u.click()})),u.on("change",(function(e){c.addClass("vmwpmdp-busy");let t=e.target.files[0];x(t)?p(t):c.removeClass("vmwpmdp-busy")})),e(".vmwpmdp-wpvoicemessage-reset-key-btn").on("click",(function(){m.val(""),e("#submit").trigger("click")})),qcld_wpvm_vmwpmdp_voicemssg_unsaved=!1}))}(jQuery);